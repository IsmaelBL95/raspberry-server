# Definimos el backend interno (tu servicio Node/Express)
upstream backend_upstream {
    server backend:5000;
    keepalive 32;
}

server {
    listen 80;
    server_name _;

    # Cabeceras de seguridad comunes (snippets/security-headers.conf)
    include /etc/nginx/snippets/security-headers.conf;

    # Tama침o m치ximo de payload (subidas)
    client_max_body_size 10m;

    # API: todo lo que empiece por /api/ va al backend
    location /api/ {
        include /etc/nginx/snippets/proxy-params.conf;
        proxy_pass http://backend_upstream;
    }

    # (Opcional) est치ticos: lo dejamos preparado, pero comentado
    # location /assets/ {
    #     alias /usr/share/nginx/html/assets/;
    #     access_log off;
    #     expires 7d;
    #     add_header Cache-Control "public, max-age=604800, immutable";
    # }

    # Todo lo dem치s: de momento devolvemos 404
    location / {
        return 404;
    }
}